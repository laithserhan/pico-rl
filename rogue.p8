pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
--init
function _init()
 t=0
 w,h=8,6
 dungeon={}
 
 --generate dummy dungeon
 for x=1,16 do
  for y=1,16 do
   if(rnd(5)<1)dungeon[x..","..y]="█"
  end
 end
 
 mobs={}
 
 player=mob:new{
  c="웃",
  col=11,
  x=5,
  y=5,
  move=function(self)
   local x=self.x+dirs[move][1]
   local y=self.y+dirs[move][2]
   if not dungeon[x..","..y] then
    self.x,self.y=x,y
   end
  end
 }
 add(mobs,player)
 
 --generate dummy mobs
 for _=1,7 do
  add(mobs,mob:new({c="😐",x=flr(rnd(16)),y=flr(rnd(16))}))
 end
  
 cam={x=0,y=0}
 
 dirs={
  {-1,0},
  {1,0},
  {0,0},
  {0,-1},
  {-1,-1},
  {1,-1},
  {0,0},
  {0,1},
  {-1,1},
  {1,1}}
end
-->8
-- mob
mob={
 c="",
 col=8,
 move=function(self)
  local f={1,2,4,5,6,8,9,10}
  r=ceil(rnd(#f))
  local m=dirs[f[r]]
  local x=self.x+m[1]
  local y=self.y+m[2]
  if not dungeon[x..","..y] then
   self.x,self.y=x,y
  end
 end,
 new=function(self,o)
  self.__index=self
  return setmetatable(o or {},self)
 end
}
-->8
--update
function _update()
 move=btnp()
 if move>0 and move<15 then
  t+=1
  for m in all(mobs) do
   m:move()
  end
 end
 
 --scroll
 if (player.x+cam.x/8>15) cam.x-=w
 if (player.x+cam.x/8<1) cam.x+=w
 if (player.y+cam.y/8>18) cam.y-=h
 if (player.y+cam.y/8<1) cam.y+=h
end
-->8
--draw
function _draw()
 cls()

--[[ 
 for coords,item in pairs(dungeon) do
  print(item,coords[1]*w+cam.x,coords[2]*h+cam.y,6)
 end
]]

 for x=1,50 do
  for y=1,50 do
   local item=dungeon[x..","..y]
   if item then
    print("█",x*w+cam.x,y*h+cam.y,6)
   else
    print(".",x*w+cam.x+2,y*h+cam.y-2,5)
   end
  end
 end
 
 for m in all(mobs) do
  print(m.c,m.x*w+cam.x,m.y*h+cam.y,m.col)
 end

 --hud 
 print("♥",0,128-h)
 
 --[[
 for i=0,4 do
  print("pirogue",64-(5*4)/2+i,64+i,8)
 end
 i=5
 print("pirogue",64-(5*4)/2+i,64+i,10)
 ]]
end
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000a00000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000a00000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
